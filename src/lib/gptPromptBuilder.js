// src/lib/gptPromptBuilder.js
// GPT에 전달할 프롬프트를 생성하는 기능

/**
 * 주식 분석을 위한 프롬프트를 생성합니다.
 * @param {object} stock - 분석할 주식 정보
 * @returns {string} - GPT에 전달할 프롬프트
 */
export const buildStockPrompt = (stock) => {
    if (!stock) return '';
    
    return `
  다음 주식에 대한 전문적인 투자 분석 보고서를 작성해주세요:
  
  티커: ${stock.ticker}
  회사명: ${stock.companyName}
  PER: ${stock.per}
  ROE: ${stock.roe}%
  배당률: ${stock.dividendYield}%
  섹터: ${stock.sector}
  시가총액: ${stock.marketCap}억 달러
  
  요구사항:
  1. 종목 요약: 기업의 핵심 비즈니스와 현재 상황에 대한 객관적 요약
  2. 재무 분석: PER, ROE, 배당률 등에 기반한 재무적 강점과 약점 분석
  3. 산업 분석: ${stock.sector} 섹터의 현재 동향과 전망, 해당 종목의 섹터 내 위치
  4. 투자 스타일 적합도 평가:
     - 안정형 투자자 적합도 (배당, 변동성, 재무안정성 고려)
     - 성장형 투자자 적합도 (성장 잠재력, 미래 전망 고려)
     - 단타형 트레이더 적합도 (변동성, 모멘텀 고려)
  5. 기술적 분석 요약 (가정하여 작성):
     - 이동평균선 현황 (20일선, 50일선, 200일선 기준)
     - RSI 상황 (과매수/과매도 여부)
     - MACD 신호 (골든크로스/데드크로스 여부)
  6. 추천 매수 구간: 기술적/기본적 분석 기반의 매수 가격대 제안 ($xxx~$xxx 형식)
  7. 매도 타이밍 제안: 목표가 또는 기술적 지표 기반 매도 시점 제안
  8. 종합 의견: 투자 적합성과 리스크 요약, 투자 시 주의점
  
  분석 스타일은 투자 리서치 보고서처럼 자연스럽고 명료하게 작성해주세요.
  각 섹션을 분리하여 명확하게 표시해주세요.
  최신 재무데이터나 뉴스가 없다면, 일반적인 분석에 집중해 주세요.
  `;
  };
  
  /**
   * ETF 분석을 위한 프롬프트를 생성합니다.
   * @param {object} etf - 분석할 ETF 정보
   * @returns {string} - GPT에 전달할 프롬프트
   */
  export const buildEtfPrompt = (etf) => {
    if (!etf) return '';
    
    return `
  다음 ETF에 대한 전문적인 투자 분석 보고서를 작성해주세요:
  
  티커: ${etf.ticker}
  ETF명: ${etf.name}
  테마/섹터: ${etf.theme}
  배당률: ${etf.dividendYield}%
  총보수율: ${etf.expenseRatio}%
  운용자산규모: ${etf.aum}억 달러
  레버리지 여부: ${etf.isLeveraged ? '예 (레버리지 ETF)' : '아니오'}
  
  요구사항:
  1. ETF 요약: ETF의 투자 목적, 추종 지수, 주요 구성 종목 특성에 대한 요약
  2. 배당 및 비용 분석: 배당률(${etf.dividendYield}%)과 총보수율(${etf.expenseRatio}%)의 수준과 의미
  3. 테마 분석: ${etf.theme} 테마의 현재 동향과 전망
  4. 투자 스타일 적합도 평가:
     - 안정형 투자자 적합도 (배당, 변동성, 분산투자 효과 고려)
     - 성장형 투자자 적합도 (성장 잠재력, 테마 전망 고려)
     - 단타형 트레이더 적합도 (변동성, 모멘텀 고려${etf.isLeveraged ? ', 레버리지 효과 감안' : ''})
  5. 기술적 분석 요약 (가정하여 작성):
     - 이동평균선 현황 (20일선, 50일선, 200일선 기준)
     - RSI 상황 (과매수/과매도 여부)
     - MACD 신호 (골든크로스/데드크로스 여부)
  6. 추천 매수 구간: 기술적 분석 기반의 매수 가격대 제안 ($xxx~$xxx 형식)
  7. 매도 타이밍 제안: 목표가 또는 기술적 지표 기반 매도 시점 제안
  8. 종합 의견: 투자 적합성과 리스크 요약, 투자 시 주의점${etf.isLeveraged ? ', 레버리지 ETF의 장단기 효과 설명' : ''}
  
  분석 스타일은 투자 리서치 보고서처럼 자연스럽고 자세하게 작성해주세요.
  주식 초보도 다 알아들을수 있게 말이죠.
  각 섹션을 분리하여 명확하게 표시해주세요.
  최신 시장 데이터나 뉴스가 없다면, 일반적인 분석에 집중해 주세요.
  `;
  };
  
  export default { buildStockPrompt, buildEtfPrompt };